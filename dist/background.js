!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=42)}({13:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){var t=this;this.get=function(e){var n="store."+t.name+"."+e;if(null!==localStorage.getItem(n))try{return JSON.parse(localStorage.getItem(n))}catch(t){return null}},this.set=function(e,n){if(void 0===n)t.remove(e);else{if("function"==typeof n)n=null;else try{n=JSON.stringify(n)}catch(t){n=null}localStorage.setItem("store."+t.name+"."+e,n)}return t},this.remove=function(e){return localStorage.removeItem("store."+t.name+"."+e),t},this.removeAll=function(){for(var e="store."+t.name+".",n=localStorage.length-1;n>=0;n--)localStorage.key(n).substring(0,e.length)===e&&localStorage.removeItem(localStorage.key(n));return t},this.toObject=function(){for(var e={},n=void 0,r=void 0,o="store."+t.name+".",a=localStorage.length-1;a>=0;a--)localStorage.key(a).substring(0,o.length)===o&&(n=localStorage.key(a).substring(o.length),void 0!==(r=t.get(n))&&(e[n]=r));return e},this.fromObject=function(e,n){for(var r in!0!==n&&t.removeAll(),e)e.hasOwnProperty(r)&&t.set(r,e[r]);return t}};e.default=function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r.call(this),this.name=e,void 0!==n)for(var o in n)n.hasOwnProperty(o)&&void 0===this.get(o)&&this.set(o,n[o])}},36:function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}t.exports={sendToOption:function(t){var e=[],n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value.id;e.push(c)}}catch(t){o=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}var l=new Date,u=l.getFullYear(),d=l.getMonth()+1,f=l.getDate(),h=parseInt(new Date(u+"-"+d+"-"+f+" 05:00:00").getTime()/1e3),g=parseInt((new Date).getTime()/1e3);fetch("https://granbluefantasy.trim21.cn/api/v0.1/teamraid039/group/individual",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:JSON.stringify({user_ids:e,start:h,end:g})}).then(function(t){return t.json()}).then(function(e){var n=e.data,o=void 0===n?[]:n,a=[];for(var i in o){var s=o[i],c=s.user_id,l=s.history;if(l){for(var u,d,f=Object.keys(l),h=0,g=f.length;h<g;h++)f[h]=parseInt(f[h]);var p=Math.max.apply(Math,r(f));u=l[p],d=l[Math.min.apply(Math,r(f))];var m=new Date(1e3*p);m=m.getFullYear()+"-"+(m.getMonth()+1)+"-"+m.getDate()+" "+m.getHours()+":"+m.getMinutes()+":"+m.getSeconds(),a.push({id:c,singleDayPoint:u.point-d.point,rank:u.rank,totalPoint:u.point,timeStamp:m})}else a.push({id:c,singleDayPoint:void 0,rank:void 0,totalPoint:void 0,timeStamp:void 0})}var v=[],y=!0,b=!1,_=void 0;try{for(var S,w=t[Symbol.iterator]();!(y=(S=w.next()).done);y=!0){var j=S.value,O=!0,k=!1,I=void 0;try{for(var x,B=a[Symbol.iterator]();!(O=(x=B.next()).done);O=!0){var M=x.value;j.id==M.id&&v.push(Object.assign({},j,M))}}catch(t){k=!0,I=t}finally{try{!O&&B.return&&B.return()}finally{if(k)throw I}}}}catch(t){b=!0,_=t}finally{try{!y&&w.return&&w.return()}finally{if(b)throw _}}window.memberDatas=v})}}},37:function(t,e,n){"use strict";t.exports={initGacha:function(t,e){chrome.tabs.query({active:!0,currentWindow:!0},function(t){chrome.tabs.connect(t[0].id,{name:"popup_to_content"}).postMessage({message:"init_eunuch",status:e})})}}},38:function(t,e,n){"use strict";var r=function(t){chrome.tabs.query({active:!0},function(e){var n=void 0,r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var c=i.value,l=c.id;c.url;if(c.url.includes("game")){n=l;break}}}catch(t){o=!0,a=t}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}var u=chrome.tabs.connect(n,{name:"popup_to_content"}),d=document.getElementById("battle_input");d.focus(),d.value="",document.execCommand("paste");var f=d.value.trim();/^[A-Za-z0-9]+$/gi.test(f)&&8==f.length?u.postMessage({message:"battle_key_check",battleId:f,userId:t}):console.log("check failed")})};t.exports={initInputForBattle:function(){var t=document.getElementById("battle_input");t||((t=document.createElement("input")).id="battle_input",t.style.width="0px",t.style.height="0px",document.body.appendChild(t))},getBattleRoomHref:function(t,e){e?r(t):chrome.browserAction.onClicked.addListener(function(){r(t)})},handleBoardPost:r}},39:function(t,e,n){"use strict";var r=n(5);t.exports={initUserId:function(t){!t.get("userId")&&(0,r.getByCookie)("http://game.granbluefantasy.jp/user/user_id",{},function(e){var n=e.user_id;t.set("userId",n)})}}},40:function(t,e,n){"use strict";t.exports={zoom:1.5,isLeftSiderShow:!0,isRightSiderShow:!1,headAddress:"http://",address:"localhost:8023",blackList:[],isScrollStyleShow:!1,isMultil:!1,isListenBoard:!1,isListenBp:!1,isRape:!1,isEunuch:!1}},41:function(t,e,n){"use strict";var r=o(n(40));function o(t){return t&&t.__esModule?t:{default:t}}var a=new(o(n(13)).default)("options");fetch("./assets/blackList.json",{}).then(function(t){return t.json()}).then(function(t){var e=a.get("blackList"),n=[],r=!0,o=!1,i=void 0;try{for(var s,c=t[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value,u=l.id;if(e&&e.length>0){var d=!0,f=!1,h=void 0;try{for(var g,p=e[Symbol.iterator]();!(d=(g=p.next()).done);d=!0){var m=g.value;m.id==u&&n.push(Object.assign({},m,l))}}catch(t){f=!0,h=t}finally{try{!d&&p.return&&p.return()}finally{if(f)throw h}}}else n=t}}catch(t){o=!0,i=t}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}a.set("blackList",n)});var i=a.toObject();a.fromObject(Object.assign({},r.default,i));t.exports={local:a}},42:function(t,e,n){"use strict";var r=n(41),o=n(39),a=n(38),i=n(37),s=n(36);window.store=r.local,(0,o.initUserId)(r.local),chrome.browserAction.setPopup({popup:r.local.get("isMultil")?"":"index.html"}),chrome.tabs.onUpdated.addListener(function(t,e,n){n.url.includes("gacha")&&(0,i.initGacha)(n.url,r.local.get("isEunuch"))}),(0,a.initInputForBattle)(),(0,a.getBattleRoomHref)(r.local.get("userId"),r.local.get("isListenBoard")),chrome.runtime.onMessage.addListener(function(t,e,n){var o=t.message,i=(t.zoom,t.search,t.url),c=t.data,l={error:"",tasks:""};switch(o){case"get_zoom":l=Object.assign(l,{zoom:r.local.get("zoom")});break;case"get_search":l=Object.assign(l,{search:r.local.get("search")});break;case"get_sider_options":l=Object.assign(l,{left:r.local.get("isLeftSiderShow"),right:r.local.get("isRightSiderShow")});break;case"get_scroll_options":l=Object.assign(l,{status:r.local.get("isScrollStyleShow")});break;case"battle_room_href":chrome.tabs.update(e.tab.id,{url:"http://game.granbluefantasy.jp"+i});break;case"get_userId":l=Object.assign(l,{userId:r.local.get("userId")});break;case"redo_battle_room_href_check":(0,a.handleBoardPost)(r.local.get("userId"));break;case"notify_error":chrome.notifications.create({type:"basic",iconUrl:"./assets/img/54878633_p0.png",title:"进房异常",message:c});break;case"isEunuch":l=Object.assign(l,{status:r.local.get("isEunuch")});break;case"listenClipBoardBattleCheck":(0,a.getBattleRoomHref)(r.local.get("userId"),r.local.get("isListenBoard"));break;case"do_getMemberId":(0,s.sendToOption)(c)}n(l)})},5:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.uploadToServer=function(t,e,n){if(t){var r={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}};r=Object.assign(r,e),fetch(t,r).then(function(t){return t.text()}).then(function(t){return n(t)}).catch(function(t){console.log(t)})}},e.getByCookie=function(t,e,n){if(t){var r={credentials:"include"};r=Object.assign(r,e),fetch(t,r).then(function(t){return t.json()}).then(function(t){return n(t)}).catch(function(t){console.log(t)})}},e.postByCookie=function(t,e,n){if(t){var r={method:"POST",credentials:"include",headers:{"Content-Type":"application/json; charset=UTF-8"}};r=Object.assign(r,e),fetch(t,r).then(function(t){return console.log(t),t.text()}).then(function(t){console.log(t),n(JSON.parse(t))}).catch(function(t){console.log(t)})}},e.dispatchInjectToContentScript=function(t){return document.getElementById("init_window").dispatchEvent(new CustomEvent("inject_to_content_script",{detail:t}))},e.dispatchContentScriptToInject=function(t){return document.getElementById("init_window").dispatchEvent(new CustomEvent("content_script_to_inject",{detail:t}))}}});